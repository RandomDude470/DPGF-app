{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/Services/dpgf.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"../nav/nav.component\";\nimport * as i5 from \"../default-screen/default-screen.component\";\nimport * as i6 from \"../lot/lot.component\";\nfunction MainComponent_span_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"\\uD83D\\uDDAB Enregistrer\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction MainComponent_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Saving ...\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction MainComponent_app_default_screen_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-default-screen\", 10);\n    i0.ɵɵlistener(\"notify\", function MainComponent_app_default_screen_10_Template_app_default_screen_notify_0_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.OnNotifyDefaulrScreen($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"lotList\", ctx_r2.LotList);\n  }\n}\nfunction MainComponent_app_lot_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-lot\", 11);\n    i0.ɵɵlistener(\"notify\", function MainComponent_app_lot_11_Template_app_lot_notify_0_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.OnNotifyLot($event));\n    })(\"exit\", function MainComponent_app_lot_11_Template_app_lot_exit_0_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.showDefault = true);\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"Lot\", ctx_r3.fetchLotByIdAndDisplay(ctx_r3.CurrentLot));\n  }\n}\nexport class MainComponent {\n  ///// constructor\n  constructor(dpgf, route, router) {\n    this.dpgf = dpgf;\n    this.route = route;\n    this.router = router;\n    ///// Variables \n    this.dpgfId = '';\n    this.LotList = []; //list of lots from dpgf\n    this.showDefault = true;\n    this.Total = 0;\n    this.saving = false;\n  }\n  //// methods :\n  CalcSum() {\n    this.Total = 0;\n    this.DPGF.lots.forEach(lot => {\n      if (!isNaN(Number(lot.total))) {\n        this.Total += Number(lot.total);\n      }\n    });\n    this.DPGF.total = String(this.Total);\n  }\n  isArray(arr) {\n    return Array.isArray(arr);\n  }\n  getIdFromUrl() {\n    this.route.paramMap.subscribe(r => {\n      this.dpgfId = r.get('id');\n    });\n  }\n  InitializeDpgfAndLotList() {\n    this.dpgf.getDpgf(this.dpgfId).subscribe(dpgf => {\n      if (typeof dpgf == 'number') {\n        console.log(\"error fetching dpgf\".toUpperCase());\n      } else {\n        this.DPGF = dpgf;\n        this.DPGF.lots.forEach(lot => {\n          this.LotList.push({\n            name: lot['name'],\n            _id: lot[\"_id\"],\n            total: lot[\"total\"]\n          });\n          if (lot.sousLots == undefined || lot.sousLots == null) {\n            lot.sousLots = [];\n          }\n          this.CurrentLot = this.DPGF.lots[0]._id;\n        });\n        this.Total = Number(this.DPGF.total);\n        console.log(this.DPGF);\n      }\n    });\n  }\n  FindLotByIdAndReplace(ReplacementLot) {\n    let i = 0;\n    let flag = false;\n    this.DPGF.lots.forEach(lot => {\n      if (lot._id == ReplacementLot._id) {\n        this.DPGF.lots[i] = ReplacementLot;\n        flag = true;\n      }\n      i++;\n    });\n    return flag;\n  }\n  UpdateLotList() {\n    this.LotList = [];\n    this.DPGF.lots.forEach(lot => {\n      this.LotList.push({\n        name: lot['name'],\n        _id: lot[\"_id\"],\n        total: lot[\"total\"]\n      });\n      if (lot.sousLots == undefined || lot.sousLots == null) {\n        lot.sousLots = [];\n      }\n    });\n  }\n  fetchLotByIdAndDisplay(id) {\n    for (let index = 0; index < this.DPGF.lots.length; index++) {\n      const element = this.DPGF.lots[index];\n      if (element._id == id) {\n        return element;\n      }\n    }\n    return this.DPGF.lots[0];\n  }\n  //lifecycle hooks\n  ngOnInit() {\n    this.getIdFromUrl();\n    this.InitializeDpgfAndLotList();\n  }\n  ////// Event handlers\n  OnNotifyNav(data) {\n    console.log(JSON.stringify(data) + ' was clicked !');\n    this.CurrentLot = data;\n    this.showDefault = false;\n  }\n  OnNotifyDefaulrScreen(data) {\n    console.log(JSON.stringify(data) + ' was clicked !');\n    let ndata = data;\n    this.CurrentLot = ndata['id'];\n    this.showDefault = false;\n  }\n  OnNotifyLot(event) {\n    if (!this.FindLotByIdAndReplace(event)) {\n      this.DPGF.lots.push(event);\n    }\n    this.UpdateLotList();\n    this.CalcSum();\n    console.log(this.DPGF);\n  }\n  Save() {\n    this.dpgf.SaveDPGF(this.DPGF).subscribe(status => {\n      if (status == 200) {\n        console.log('saved');\n      } else {\n        alert('Error Status : ' + status);\n      }\n    });\n  }\n}\nMainComponent.ɵfac = function MainComponent_Factory(t) {\n  return new (t || MainComponent)(i0.ɵɵdirectiveInject(i1.DpgfService), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i2.Router));\n};\nMainComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: MainComponent,\n  selectors: [[\"app-main\"]],\n  decls: 12,\n  vars: 6,\n  consts: [[1, \"test\"], [1, \"save\", 3, \"click\"], [4, \"ngIf\"], [1, \"leave\", 3, \"routerLink\"], [1, \"container\"], [1, \"left\"], [3, \"LotList\", \"notify\"], [1, \"right\"], [3, \"lotList\", \"notify\", 4, \"ngIf\"], [3, \"Lot\", \"notify\", \"exit\", 4, \"ngIf\"], [3, \"lotList\", \"notify\"], [3, \"Lot\", \"notify\", \"exit\"]],\n  template: function MainComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n      i0.ɵɵlistener(\"click\", function MainComponent_Template_div_click_1_listener() {\n        return ctx.Save();\n      });\n      i0.ɵɵtemplate(2, MainComponent_span_2_Template, 2, 0, \"span\", 2);\n      i0.ɵɵtemplate(3, MainComponent_span_3_Template, 2, 0, \"span\", 2);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"div\", 3);\n      i0.ɵɵtext(5, \" <- Retour\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"div\", 4)(7, \"div\", 5)(8, \"app-nav\", 6);\n      i0.ɵɵlistener(\"notify\", function MainComponent_Template_app_nav_notify_8_listener($event) {\n        return ctx.OnNotifyNav($event);\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(9, \"div\", 7);\n      i0.ɵɵtemplate(10, MainComponent_app_default_screen_10_Template, 1, 1, \"app-default-screen\", 8);\n      i0.ɵɵtemplate(11, MainComponent_app_lot_11_Template, 1, 1, \"app-lot\", 9);\n      i0.ɵɵelementEnd()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", !ctx.saving);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.saving);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"routerLink\", \"/home/projects/about/\" + ctx.dpgfId);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"LotList\", ctx.LotList);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.isArray(ctx.LotList) && ctx.LotList.length != 0 && ctx.showDefault);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.DPGF && ctx.isArray(ctx.DPGF.lots) && ctx.DPGF.lots.length != 0 && !ctx.showDefault);\n    }\n  },\n  dependencies: [i3.NgIf, i2.RouterLink, i4.NavComponent, i5.DefaultScreenComponent, i6.LotComponent],\n  styles: [\".test[_ngcontent-%COMP%] {\\n  height: 100vh;\\n  display: flex;\\n  flex-direction: row;\\n  justify-content: center;\\n  align-items: center;\\n  background-color: #f5f7fb;\\n}\\n.test[_ngcontent-%COMP%]   .save[_ngcontent-%COMP%], .test[_ngcontent-%COMP%]   .leave[_ngcontent-%COMP%] {\\n  color: white;\\n  background-color: #8a05ff;\\n  padding-inline: 1.5rem;\\n  padding-block: 0.3rem;\\n  border: none;\\n  border-radius: 20px;\\n  font-size: 1.2rem;\\n  font-weight: 500;\\n  box-shadow: 1px rgb(103, 0, 194);\\n  margin-top: 4rem;\\n  border: solid 1px white;\\n  cursor: pointer;\\n  transition: background-color 0.3s;\\n  position: absolute;\\n  top: -3rem;\\n  right: 2rem;\\n}\\n.test[_ngcontent-%COMP%]   .save[_ngcontent-%COMP%]:hover, .test[_ngcontent-%COMP%]   .leave[_ngcontent-%COMP%]:hover {\\n  background-color: white;\\n  color: #8a05ff;\\n  border: solid 1px #9b29ff;\\n}\\n.test[_ngcontent-%COMP%]   .save[_ngcontent-%COMP%]:active, .test[_ngcontent-%COMP%]   .leave[_ngcontent-%COMP%]:active {\\n  background-color: #e6e6e6;\\n}\\n.test[_ngcontent-%COMP%]   .leave[_ngcontent-%COMP%] {\\n  right: auto;\\n  left: 2rem;\\n}\\n.test[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-direction: row;\\n  justify-content: center;\\n  align-items: center;\\n  height: 83%;\\n  width: 75%;\\n  gap: 5%;\\n}\\n.test[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%] {\\n  border: solid 1px #9b29ff;\\n  border-radius: 30px;\\n  padding-inline: 1rem;\\n  padding-block: 2rem;\\n  background-color: white;\\n  flex-grow: 2.5;\\n  height: 100%;\\n  min-width: 16rem;\\n  box-sizing: border-box;\\n  max-width: 900px;\\n  overflow-y: auto;\\n}\\n.test[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%] {\\n  border: solid 1px #9b29ff;\\n  border-radius: 30px;\\n  padding-inline: 1rem;\\n  padding-block: 2rem;\\n  background-color: white;\\n  min-width: 8rem;\\n  max-width: 350px;\\n  flex-grow: 1;\\n  height: 100%;\\n  box-sizing: border-box;\\n}\\n.test[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]   app-nav[_ngcontent-%COMP%] {\\n  width: 50%;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvZHBnZi9tYWluL21haW4uY29tcG9uZW50LnNjc3MiLCJ3ZWJwYWNrOi8vLi9zcmMvYXNzZXRzL19taXhpbnMuc2NzcyIsIndlYnBhY2s6Ly8uL3NyYy9hc3NldHMvX0dsb2JhbFZhcnMuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFHQTtFQUNJLGFBQUE7RUNhQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSx1QkFBQTtFQUNBLG1CQUFBO0VEZEEseUJFSmdCO0FGS3BCO0FBQUk7RUNvQkEsWURuQjRDO0VDb0I1Qyx5QkFBQTtFQUNBLHNCRHJCeUQ7RUNzQnpELHFCRHRCZ0U7RUN1QmhFLFlBQUE7RUFDQSxtQkFBQTtFQUNBLGlCRHpCa0Q7RUMwQmxELGdCQUFBO0VBQ0EsZ0NBQUE7RUFDQSxnQkFBQTtFQUNBLHVCQUFBO0VBQ0EsZUFBQTtFQUNBLGlDQUFBO0VEOUJJLGtCQUFBO0VBQ0EsVUFBQTtFQUNBLFdBQUE7QUFjUjtBQ2VJO0VBQ0ksdUJEakN3QztFQ2tDeEMsY0FBQTtFQUNBLHlCQUFBO0FEYlI7QUFsQlE7RUFFSSx5QkFBQTtBQW1CWjtBQWhCSTtFQUNJLFdBQUE7RUFDQSxVQUFBO0FBa0JSO0FBaEJJO0VDSkEsYUFBQTtFQUNBLG1CQUFBO0VBQ0EsdUJBQUE7RUFDQSxtQkFBQTtFREdJLFdBQUE7RUFDQSxVQUFBO0VBQ0EsT0FBQTtBQXFCUjtBQXBCUTtFQ3NCSix5QkFBQTtFQUNBLG1CQUFBO0VBQ0Esb0JBQUE7RUFDQSxtQkFBQTtFQUNBLHVCQUFBO0VEeEJRLGNBQUE7RUFDQSxZQUFBO0VBQ0EsZ0JBQUE7RUFDQSxzQkFBQTtFQUNBLGdCQUFBO0VBQ0EsZ0JBQUE7QUEwQlo7QUFyQlE7RUNVSix5QkFBQTtFQUNBLG1CQUFBO0VBQ0Esb0JBQUE7RUFDQSxtQkFBQTtFQUNBLHVCQUFBO0VEWlEsZUFBQTtFQUNBLGdCQUFBO0VBQ0EsWUFBQTtFQUNBLFlBQUE7RUFDQSxzQkFBQTtBQTJCWjtBQXpCWTtFQUNJLFVBQUE7QUEyQmhCIiwic291cmNlc0NvbnRlbnQiOlsiQHVzZSAnLi4vLi4vLi4vYXNzZXRzL21peGlucycgYXMgbWl4IDtcclxuQHVzZSAnLi4vLi4vLi4vYXNzZXRzL0dsb2JhbFZhcnMnIGFzIHZhcnMgO1xyXG5cclxuLnRlc3R7XHJcbiAgICBoZWlnaHQ6IDEwMHZoO1xyXG4gICAgQGluY2x1ZGUgbWl4LmZsZXgtaG9yLWNlbjtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHZhcnMuJGNvbG9yLWJhY2tncm91bmQgO1xyXG4gICAgLnNhdmUgLCAubGVhdmV7XHJcbiAgICAgICAgQGluY2x1ZGUgbWl4LmJ1dHRvbih2YXJzLiRjb2xvci1wcmltYXJ5LHdoaXRlLDEuMnJlbSwxLjVyZW0sLjNyZW0pO1xyXG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgICAgICB0b3A6IC0zcmVtO1xyXG4gICAgICAgIHJpZ2h0OiAycmVtO1xyXG4gICAgICAgICY6YWN0aXZle1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogZGFya2VuKHdoaXRlLDEwKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAubGVhdmV7XHJcbiAgICAgICAgcmlnaHQ6IGF1dG87XHJcbiAgICAgICAgbGVmdDogMnJlbTtcclxuICAgIH1cclxuICAgIC5jb250YWluZXJ7XHJcbiAgICAgICAgQGluY2x1ZGUgbWl4LmZsZXgtaG9yLWNlbjtcclxuICAgICAgICBoZWlnaHQ6IDgzJTtcclxuICAgICAgICB3aWR0aDogNzUlO1xyXG4gICAgICAgIGdhcDogNSU7XHJcbiAgICAgICAgLnJpZ2h0e1xyXG4gICAgICAgICAgICBAaW5jbHVkZSBtaXgucm91bmQtYm94O1xyXG4gICAgICAgICAgICBmbGV4LWdyb3c6IDIuNTtcclxuICAgICAgICAgICAgaGVpZ2h0OiAxMDAlO1xyXG4gICAgICAgICAgICBtaW4td2lkdGg6IDE2cmVtO1xyXG4gICAgICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xyXG4gICAgICAgICAgICBtYXgtd2lkdGg6IDkwMHB4O1xyXG4gICAgICAgICAgICBvdmVyZmxvdy15IDogYXV0bztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgLy8gYmFja2dyb3VuZC1jb2xvcjogdmFycy4kY29sb3ItcHJpbWFyeTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIC5sZWZ0e1xyXG4gICAgICAgICAgICBAaW5jbHVkZSBtaXgucm91bmQtYm94O1xyXG4gICAgICAgICAgICBtaW4td2lkdGg6IDhyZW07XHJcbiAgICAgICAgICAgIG1heC13aWR0aDogMzUwcHg7XHJcbiAgICAgICAgICAgIGZsZXgtZ3JvdzogMTtcclxuICAgICAgICAgICAgaGVpZ2h0OiAxMDAlO1xyXG4gICAgICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xyXG4gICAgICAgICAvLyAgIGJhY2tncm91bmQtY29sb3I6IGJsdWU7XHJcbiAgICAgICAgICAgIGFwcC1uYXZ7XHJcbiAgICAgICAgICAgICAgICB3aWR0aDogNTAlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuXHJcbn0iLCJAdXNlICcuL0dsb2JhbFZhcnMnIGFzIHZhcnM7XHJcblxyXG5AbWl4aW4gZmxleC1ob3Ige1xyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGZsZXgtZGlyZWN0aW9uOiByb3c7XHJcbn1cclxuQG1peGluIGZsZXgtdmVye1xyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbn1cclxuQG1peGluIGZsZXgtdmVyLWNlbntcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG59XHJcbkBtaXhpbiBmbGV4LWhvci1jZW57XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgZmxleC1kaXJlY3Rpb246IHJvdztcclxuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxufVxyXG5AbWl4aW4gbWFyZ2luLWF1dG8tY2VudGVyIHtcclxuICAgIGRpc3BsYXkgOiBibG9jaztcclxuICAgIG1hcmdpbi1pbmxpbmUgOiBhdXRvO1xyXG59XHJcbkBtaXhpbiBidXR0b24oJHByICwgJHNlYywkZm9udC1zaXplICwgJHBhZGRpbmctaW5saW5lLCAkcGFkZGluZy1ibG9jaykge1xyXG4gICAgY29sb3IgOiAkc2VjO1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogbGlnaHRlbigkY29sb3I6ICRwciAsICRhbW91bnQ6IDEzKTtcclxuICAgIHBhZGRpbmctaW5saW5lOiAkcGFkZGluZy1pbmxpbmU7XHJcbiAgICBwYWRkaW5nLWJsb2NrOiAkcGFkZGluZy1ibG9jaztcclxuICAgIGJvcmRlcjogbm9uZTtcclxuICAgIGJvcmRlci1yYWRpdXMgOiAyMHB4O1xyXG4gICAgZm9udC1zaXplIDogJGZvbnQtc2l6ZSA7XHJcbiAgICBmb250LXdlaWdodDogNTAwO1xyXG4gICAgYm94LXNoYWRvdzogMXB4ICRwcjtcclxuICAgIG1hcmdpbi10b3A6IDRyZW07XHJcbiAgICBib3JkZXI6IHNvbGlkIDFweCAkc2VjO1xyXG4gICAgY3Vyc29yOiBwb2ludGVyO1xyXG4gICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAuM3M7XHJcbiAgICAmOmhvdmVye1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6ICRzZWM7XHJcbiAgICAgICAgY29sb3I6IGxpZ2h0ZW4oJGNvbG9yOiAkcHIgLCAkYW1vdW50OiAxMyk7XHJcbiAgICAgICAgYm9yZGVyOiBzb2xpZCAxcHggbGlnaHRlbigkY29sb3I6ICRwciwgJGFtb3VudDogMjApO1xyXG5cclxuICAgIH1cclxufVxyXG5AbWl4aW4gcm91bmQtYm94IHtcclxuICAgIGJvcmRlcjogc29saWQgMXB4IGxpZ2h0ZW4oJGNvbG9yOiB2YXJzLiRjb2xvci1wcmltYXJ5LCAkYW1vdW50OiAyMCk7XHJcbiAgICBib3JkZXItcmFkaXVzOiAzMHB4O1xyXG4gICAgcGFkZGluZy1pbmxpbmU6IDFyZW0gO1xyXG4gICAgcGFkZGluZy1ibG9jazoycmVtIDtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xyXG59IiwiJGNvbG9yLXByaW1hcnkgOiByZ2IoMTAzLCAwLCAxOTQpO1xyXG4kY29sb3Itc2Vjb25kYXJ5IDogd2hpdGU7XHJcbiRjb2xvci1iYWNrZ3JvdW5kIDogI2Y1ZjdmYiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"names":["i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","MainComponent_app_default_screen_10_Template_app_default_screen_notify_0_listener","$event","ɵɵrestoreView","_r5","ctx_r4","ɵɵnextContext","ɵɵresetView","OnNotifyDefaulrScreen","ɵɵproperty","ctx_r2","LotList","MainComponent_app_lot_11_Template_app_lot_notify_0_listener","_r7","ctx_r6","OnNotifyLot","MainComponent_app_lot_11_Template_app_lot_exit_0_listener","ctx_r8","showDefault","ctx_r3","fetchLotByIdAndDisplay","CurrentLot","MainComponent","constructor","dpgf","route","router","dpgfId","Total","saving","CalcSum","DPGF","lots","forEach","lot","isNaN","Number","total","String","isArray","arr","Array","getIdFromUrl","paramMap","subscribe","r","get","InitializeDpgfAndLotList","getDpgf","console","log","toUpperCase","push","name","_id","sousLots","undefined","FindLotByIdAndReplace","ReplacementLot","i","flag","UpdateLotList","id","index","length","element","ngOnInit","OnNotifyNav","data","JSON","stringify","ndata","event","Save","SaveDPGF","status","alert","ɵɵdirectiveInject","i1","DpgfService","i2","ActivatedRoute","Router","selectors","decls","vars","consts","template","MainComponent_Template","rf","ctx","MainComponent_Template_div_click_1_listener","ɵɵtemplate","MainComponent_span_2_Template","MainComponent_span_3_Template","MainComponent_Template_app_nav_notify_8_listener","MainComponent_app_default_screen_10_Template","MainComponent_app_lot_11_Template","ɵɵadvance"],"sources":["C:\\Users\\Yassir\\Desktop\\web\\Angular-test\\aglo-clone\\src\\app\\dpgf\\main\\main.component.ts","C:\\Users\\Yassir\\Desktop\\web\\Angular-test\\aglo-clone\\src\\app\\dpgf\\main\\main.component.html"],"sourcesContent":["import { Component,OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { DpgfService } from 'src/app/Services/dpgf.service';\nimport { Lot } from '../lot/lot.component';\nimport { findIndex } from 'rxjs';\n\n export type dpgf = {\n  _id : string,\n  total : string,\n  project : string,\n  lots :Array<Lot>\n}\n@Component({\n  selector: 'app-main',\n  templateUrl: './main.component.html',\n  styleUrls: ['./main.component.scss']\n})\n\n\n\nexport class MainComponent implements OnInit {\n  ///// Variables \n  dpgfId : string | null= ''\n  DPGF! : dpgf; // dpgf has everything all data\n  LotList : Array<Record<string ,string>>=[] //list of lots from dpgf\n  showDefault = true\n  CurrentLot! : string \n  Total = 0\n  saving = false\n\n\n\n\n  ///// constructor\n  constructor (private dpgf : DpgfService , private route  : ActivatedRoute, private router : Router){}\n\n\n\n\n\n\n\n\n  //// methods :\n  CalcSum(){\n    this.Total = 0\n    this.DPGF.lots.forEach((lot)=>{\n      if (!isNaN(Number(lot.total))) {\n        this.Total += Number(lot.total)\n      }\n    })\n    this.DPGF.total = String(this.Total)\n  }\n  isArray(arr  : any){return Array.isArray(arr)}\n  getIdFromUrl(){\n    this.route.paramMap.subscribe((r)=>{\n      this.dpgfId = r.get('id')\n    })\n\n  }\n\n  InitializeDpgfAndLotList(){\n    this.dpgf.getDpgf(this.dpgfId as string)\n    .subscribe(\n      (dpgf)=>{\n        if (typeof(dpgf) == 'number') {\n          console.log(\"error fetching dpgf\".toUpperCase());\n          \n        } else {\n          this.DPGF = dpgf as dpgf\n          this.DPGF.lots.forEach((lot)=>{\n            this.LotList.push({name: lot['name'] as string,_id :lot[\"_id\"] as string, total : lot[\"total\"] as string })\n            if (lot.sousLots  == undefined || lot.sousLots== null) {\n              lot.sousLots =[]\n              \n            }\n            this.CurrentLot = this.DPGF.lots[0]._id\n\n          })\n          this.Total = Number(this.DPGF.total)\n         console.log(this.DPGF);\n         \n          \n        }\n      }\n    )\n  }\n  FindLotByIdAndReplace(ReplacementLot : Lot){\n    let i = 0\n    let flag = false\n    this.DPGF.lots.forEach((lot)=>{\n      if (lot._id == ReplacementLot._id) {\n        this.DPGF.lots[i] = ReplacementLot\n        flag = true\n      } \n      i++\n    })\n    return flag\n  }\nUpdateLotList(){\n  this.LotList = []\n    this.DPGF.lots.forEach((lot)=>{\n      this.LotList.push({name: lot['name'] as string,_id :lot[\"_id\"] as string, total : lot[\"total\"] as string })\n      if (lot.sousLots  == undefined || lot.sousLots== null) {\n        lot.sousLots =[]\n        \n      }\n    })\n}\n  fetchLotByIdAndDisplay(id : string){\n    for (let index = 0; index < this.DPGF.lots.length; index++) {\n      const element = this.DPGF.lots[index];\n      if (element._id == id) {\n        return element\n      }\n      \n    }\n    return this.DPGF.lots[0]\n  }\n\n\n\n\n\n  //lifecycle hooks\n\n  ngOnInit() {\n    this.getIdFromUrl()\n    this.InitializeDpgfAndLotList()   \n  }\n\n\n\n\n\n\n  ////// Event handlers\n  OnNotifyNav(data: string){\n    console.log(JSON.stringify(data)+' was clicked !');\n    this.CurrentLot = data\n    this.showDefault = false\n    \n  }\n  OnNotifyDefaulrScreen(data: Object){\n    console.log(JSON.stringify(data)+' was clicked !');\n    let ndata = data as Record<string,string>\n    this.CurrentLot = ndata['id']\n    this.showDefault = false\n    \n  }\n  OnNotifyLot(event : Lot){\n    if (!this.FindLotByIdAndReplace(event)) {\n      this.DPGF.lots.push(event)\n    }\n    this.UpdateLotList()\n    this.CalcSum()\n    console.log(this.DPGF);\n  }\n  Save() {\n    this.dpgf.SaveDPGF(this.DPGF).subscribe((status)=>{\n      if (status == 200) {\n        console.log('saved');\n        \n      } else {\n        alert('Error Status : '+status)\n      }\n    })\n  }\n  \n  \n}\n","<div class=\"test\">\n    <div class=\"save\" (click)=\"Save()\"> <span *ngIf=\"!saving\">🖫 Enregistrer</span> <span *ngIf=\"saving\">Saving ...</span></div>\n    <div class=\"leave\" [routerLink]=\"'/home/projects/about/'+dpgfId\"> &lt;- Retour</div>\n    <div class=\"container\">\n\n        <div class=\"left\">\n            <app-nav [LotList]=\"LotList\" (notify)=\"OnNotifyNav($event)\"></app-nav>\n        </div>\n        <div class=\"right\">\n            \n            <app-default-screen *ngIf=\" isArray(LotList) && LotList.length != 0 && showDefault\" [lotList]=\"LotList \" (notify)=\"OnNotifyDefaulrScreen($event)\"></app-default-screen>\n            <app-lot *ngIf=\"DPGF && isArray(DPGF.lots) && DPGF.lots.length != 0  && !showDefault\" [Lot]=\"fetchLotByIdAndDisplay(CurrentLot)\" (notify)=\"OnNotifyLot($event)\" (exit)=\"showDefault= true\"></app-lot>\n            \n        </div>\n    </div>\n</div>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}